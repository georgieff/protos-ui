(function($,document){function getFunctionName(a){return((""+a).match(/function (.+?)\(/)||[,""])[1]}function getElementOffset(a){for(var b=0,c=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)b+=a.offsetLeft-a.scrollLeft,c+=a.offsetTop-a.scrollTop,a=a.offsetParent;return{top:c,left:b}}function template(a,b){this.render=function(){return convertTemplateToString(a,b)}}function createInstance(a,b,c){var e={author:b,widgetName:protos.getFunctionName(c)};a=$.extend(a,e);var f=a.widgetName,g=new c(a);$.extend(g,protos.widget[f]),$.data(a.author[0],f,g)}function convertTemplateToString(a,b){var c=$("#"+a);if(0!==c.length){var d=c.html(),e=d.displayStringsTemplate(b).executeJavaScriptInTemplate(b);return e}return a.displayStringsTemplate(b).executeJavaScriptInTemplate(b)}function generateHTML(){function f(){d+="<"+e+" "}function g(){d+="</"+e+">"}function h(){var a=c.id;d+=""!==a?'id="'+a+'" ':" "}function i(){var a=c.classes;null!==a&&(d+='class="'+a.join(" ")+'"')}function j(){d+=">"+c.text}var a={tag:"div",classes:[],text:"",id:""},b=arguments,c={tag:b[0],classes:b[1],text:b[2],id:b[3]};c=$.extend(a,c);var d="",e=c.tag;return function(){f(),h(),i(),j(),g()}(),d}function popUpCore(a){this.author=$(a.author.selector);var b=!1,c=protos.generateHTML,d="p-closePopUpButton",e="p-popUpContent",f=".p-PopUp";this.darkLayerHtml='<div class="p-darkLayer" style="background-color: rgba(0,0,0,'+a.darkness+'); "></div>',this.contentHtml=c("div",[e],a.content),this.titleHtml=c("div",["p-popUpTitle"],a.title),this.closePopUpButtonHtml='<a href="#">'+c("div",[d],"X")+"</a>",this.body=$("body");var g=this;return function(){g.author.on("showPopUp",function(){b||g.showPopUp(a)}),g.author.on("hidePopUp",function(){g.hidePopUp()})}(),this.show=function(){g.author.trigger("showPopUp")},this.hide=function(){g.author.trigger("hidePopUp")},this.showPopUp=function(a){popUpObject=g.addElements(a.darkness),g.addStyles(a,popUpObject);var c=$.data(g.author[0],a.widgetName);g.attachCloseEvents(c),b=!0},this.attachCloseEvents=function(a){$("div"+f+" a").on("click","."+d,function(){a.hide()}),g.body.on("click",".p-darkLayer",function(){a.hide()})},this.hidePopUp=function(){$(f).remove(),$(".p-darkLayer").remove(),b=!1},this.addElements=function(){g.popUpHtml='<div class="p-PopUp">'+g.closePopUpButtonHtml+g.addTitle()+g.contentHtml+"</div>",g.body.append(g.darkLayerHtml),g.body.append(g.popUpHtml),g.makeTitleDraggable();var a=$(f,"body");return a},this.addStyles=function(a,b){document.body;var d=window.innerWidth/2-a.width/2,g=window.innerHeight/2-a.height/2;b.css({left:d+"px",top:g+"px",width:a.width+"px",height:a.height+"px",position:"fixed"}),$("."+e,"div"+f).css({width:a.width+"px",height:a.height-50+"px","overflow-y":"auto","overflow-x":"auto"})},this.makeTitleDraggable=function(){a.title&&a.draggable===!0&&$(".p-popUpTitle").protos().draggable({moveParent:f,isParentDraggable:a.isContentDraggable===!0?!0:!1})},this.addTitle=function(){return a.title?g.titleHtml:""},this}function popUp(a){var b={width:500,height:300,darkness:.3,title:"Window",draggable:!0};a=$.extend(b,a);var c=new popUpCore(a);return c}function alertPopUp(a){var b={width:380,height:120,author:$(document),widgetName:"alertPopUp",darkness:.3,title:"JavaScript Alert",draggable:!0};a=$.extend(b,a),a.content+='<div style="padding-top: 15px; text-align: center;"><button id="protosOKbutton">Ok</button></div>';var c=new popUpCore(a),d=a.author[0];return c.hidePopUp=function(){$(".p-PopUp").remove(),$(".p-darkLayer").remove(),visible=!1,$.removeData(d,"alertPopUp")},c.attachCloseEvents=function(a){$("div.p-PopUp a").on("click",".p-closePopUpButton",function(){a.hide()}),$("#protosOKbutton").on("click",function(){a.hide()})},$.data(d,"alertPopUp",c),$.data(d,"alertPopUp").show(),c}function swap(a){var b=a.author;b.on(a.event,function(){b.data(a.widgetName).start()}),this.start=function(){b.animate({width:0},a.speed/2);var c=$(a.element).width();$(a.element).width(0),$(a.element).css("display",""),$(a.element).animate({width:c},a.speed/2)}}function draggable(a){var c,d,f,b=!1,e=$(a.author.selector);a.moveParent&&a.isParentDraggable?(e=$(a.moveParent),f=$(a.moveParent)):f=$(a.moveParent),e.on("mousedown",function(g){function i(a,b,c){var d={};b&&$.extend(d,{left:b+"px"}),c&&$.extend(d,{top:c+"px"}),a.css(d)}b=!0,c=g.clientX-protos.getElementOffset(this).left,d=g.clientY-protos.getElementOffset(this).top;var h=a.container;h?$(document).on("mousemove",function(b){var g=b.clientX-c,j=b.clientY-d,k=protos.getElementOffset($(h)[0]);if(h=$(a.container),protos.getElementOffset(e.element).left,g>k.left&&j>k.top){var l=protos.getElementOffset(e[0]).left+e.outerWidth(),m=protos.getElementOffset(e[0]).top+e.outerHeight(),n=k.left+h.outerWidth(),o=k.top+h.outerHeight(),p=n-e.outerWidth(),q=o-e.outerHeight()-1;n>=l?i(f,g,""):i(f,p,""),o-1>m?i(f,"",j):i(f,"",q)}}):$(document).on("mousemove",function(a){var b=a.clientX-c,e=a.clientY-d;protos.getElementOffset($(h)[0]),i(f,b,e)}),$(document).on("mouseup",function(){b=!1,$(document).unbind("mousemove")})})}$.fn.protos=function(){var a=this;return{popUp:function(b){createInstance(b,a,popUp)},alertPopUp:function(b,c){"string"==typeof b?(c={},c.content=b):c=b,createInstance(c,a,alertPopUp)},swap:function(b){createInstance(b,a,swap)},draggable:function(b){createInstance(b,a,draggable)}}},this.protos=function(){return this.widget={popUp:popUp,draggable:draggable,swap:swap,alertPopUp:alertPopUp},{template:template,getElementOffset:getElementOffset,widget:this.widget,getFunctionName:getFunctionName,generateHTML:generateHTML}}(),String.prototype.executeJavaScriptInTemplate=function(values){for(var name in values)window[name]=values[name];for(var templateHtml=this,firstIndexOfHash=templateHtml.indexOf("#"),lastIndexOfHash=templateHtml.lastIndexOf("#"),templateHtmlLenght=templateHtml.length,i=firstIndexOfHash;lastIndexOfHash>=i;i++){var startIndex=templateHtml.indexOf("#",i);if(-1===startIndex)break;startIndex+=1;var endIndex=templateHtml.indexOf("#",startIndex),stringForExecuting=templateHtml.substr(startIndex,endIndex-startIndex);templateHtml=templateHtml.substr(0,startIndex-2)+templateHtml.substr(endIndex+2,templateHtmlLenght),i=startIndex-2,eval(stringForExecuting)}return templateHtml},String.prototype.displayStringsTemplate=function(values){for(var name in values)window[name]=values[name];for(var templateHtml=this,firstIndexOfHash=templateHtml.indexOf("#="),lastIndexOfHash=templateHtml.lastIndexOf("#"),templateHtmlLenght=templateHtml.length,i=firstIndexOfHash;lastIndexOfHash>=i;i++){var startIndex=templateHtml.indexOf("#=",i);if(-1===startIndex)break;startIndex+=2;var endIndex=templateHtml.indexOf("#",startIndex),stringForExecuting=templateHtml.substr(startIndex,endIndex-startIndex);templateHtml=templateHtml.substr(0,startIndex-2)+eval(stringForExecuting)+templateHtml.substr(endIndex+1,templateHtmlLenght),i=startIndex-2}return templateHtml}})(jQuery,document);